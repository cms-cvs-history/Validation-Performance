process RESTORE =
{


   # NOTE: this example is supposed to execute AFTER
   #       running runP_WithPythiaAndQGSP.cfg, because,
   #       on input, it takes the output of the later


   untracked PSet maxEvents = { untracked int32 input = -1}
   
   service = MessageLogger
   {
      untracked vstring destinations = {"cout"}      
      untracked vstring categories = { "FwkJob", "SimG4CoreApplication" }            
      untracked PSet cout = 
      { 
         untracked PSet default = { untracked int32 limit = 0 }
	 #untracked PSet FwkJob  = { untracked int32 limit = -1 }
	 untracked PSet SimG4CoreApplication = { untracked int32 limit = -1 }
      }
   }
   
   service = Timing {}

   source = PoolSource
   {

      ## untracked vstring fileNames = {"file:minbias_detsim_inter_run0.root"}
      untracked vstring fileNames = {"file:qcd_detsim_inter_run0.root"}

      untracked uint32 skipEvents = 3   # skip the first 20 events, 
                                        # start with event 4 and
                                        # run through the end of file
					# (see maxEvents above...) 

   }
   
   service = RandomNumberGeneratorService 
   {
      untracked string restoreStateLabel = "rndmStore" # this label MUST correspond
                                                       # to what it was in the original run
						       # for the RandomEngineStateProducer
      PSet moduleSeeds =
      {
         untracked uint32 g4SimHits = 1 # it doesn't matter what seed one puts here
	                                # but some seed should be there, for the Fwk
      }
   }

   include "Configuration/StandardSequences/data/Geometry.cff"
   include "Configuration/StandardSequences/data/MagneticField.cff"
      
   include "SimG4Core/Configuration/data/SimG4Core.cff"

   # standard "prescription of what to keep in edm::Event upon output
   #
   include "Configuration/EventContent/data/EventContent.cff"

   # keeping random seeds must be added
   #
   block RndmStoreFEVT =
   {
      untracked vstring outputCommands = 
      { 
         "drop *_*_*_Sim",
	 "keep RandomEngineStates_*_*_*" 
      }
   }
   replace FEVTSIMEventContent.outputCommands += RndmStoreFEVT.outputCommands

   # Root/Pool output
   #
   module USER = PoolOutputModule 
   { 
      using FEVTSIMEventContent
      untracked string fileName = "restore_rndm_minbias_detsim.root" 
   }

   path p1 = { g4SimHits }
   endpath out = { USER }
   
}
